<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Todo App</title>
</head>
<body>
<h1>Todo List</h1>
<div id="todos"></div>
<h2>Add Todo</h2>
<form id="todoForm">
    <input type="text" id="title" placeholder="Title" required>
    <input type="text" id="description" placeholder="Description" required>
    <button type="submit">Add Todo</button>
</form>

<script>
    async function fetchTodos() {
        const response = await fetch('/todos');
        const todos = await response.json();
        const todosDiv = document.getElementById('todos');
        todosDiv.innerHTML = '';
        todos.forEach(todo => {
            todosDiv.innerHTML += `<div>
                    <h3>${todo.title}</h3>
                    <p>${todo.description}</p>
                    <button onclick="deleteTodo(${todo.ID})">Delete</button>
                    <button onclick="toggleComplete(${todo.ID})">${todo.completed ? 'Incomplete' : 'Complete'}</button>
                </div>`;
        });
    }

    async function addTodo() {
        const title = document.getElementById('title').value;
        const description = document.getElementById('description').value;
        await fetch('/todos', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({title, description})
        });
        await fetchTodos();
    }

    async function deleteTodo(id) {
        await fetch(`/todos/${id}`, {method: 'DELETE'});
        await fetchTodos();
    }

    async function toggleComplete(id) {
        const response = await fetch(`/todos/${id}`);
        const todo = await response.json();
        todo.completed = !todo.completed;
        await fetch(`/todos/${id}`, {
            method: 'PUT',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify(todo)
        });
        await fetchTodos();
    }

    document.getElementById('todoForm').addEventListener('submit', event => {
        event.preventDefault();
        addTodo();
    });

    fetchTodos();
</script>
</body>
</html>
